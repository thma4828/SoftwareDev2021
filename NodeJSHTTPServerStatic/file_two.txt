all this crazy file stuff.
